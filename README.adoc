== Ruby DDD Sample App

Details here about other sample apps. Things that are unique to this implementation.

Maybe (if I have time) could implement app in Rails using ActiveRecord with Mongoid, and then using repositories with Curator (and maybe Sinatra?). I wonder which one will be harder?

By Paul Rayner

== Implementation TODOs

* Persist aggregates using Curator & MongoDB
* Add couple of unit tests for key domain model objects - these seem kinda obtuse actually. I think I preferred the ones in the 1.1(?) master branch of the Java sample app
* Populate some sample handling events
* Update aggregates using async mechanism (using EventMachine?)
** `CargoWasHandledEventHandler`

* RoutingService
* Command handlers???

== UI - booking and tracking

* Views
** Booking
*** Assign to route
*** Cargo details
*** Change destination
*** List cargos
*** New cargo
** Handling
*** Register handling event
** Tracking
*** Track

* Controllers
** Booking
** Handling
** Tracking

== Design Decisions

Information on design choices made, and the relative tradeoffs. Plus resources for further reading.

=== Value Objects

These are great posts on DDD in Ruby with entities and VOs:

* https://deveo.com/blog/2013/03/22/immutability-in-ruby-part-1/
* https://deveo.com/blog/2013/03/28/immutability-in-ruby-part-2/

==== Immutability in Ruby

http://voormedia.com/blog/2013/02/creating-immutable-tree-data-structures-in-ruby[Creating immutable tree data structures in Ruby - Feb 2013]
http://www.confreaks.com/videos/2337-mwrc2013-immutable-ruby[Immutable Ruby presentation video (25 mins) - Michael Fairley @ MountainWest RubyConf 2013]

Some resources:

* https://rubygems.org/gems/ice_nine[Ice Nine (for deep freezing objects)]
* https://github.com/harukizaemon/hamster[Hamster - Efficient, Immutable, Thread-Safe Collection classes for Ruby]
* https://github.com/tcrayford/values
* https://github.com/solnic/virtus
* https://github.com/rouge-lang/rouge[Ruby + Clojure = Rouge]
* http://blog.rubybestpractices.com/posts/rklemme/017-Struct.html[Structs inside out]


=== Enums in Ruby

* http://stackoverflow.com/questions/75759/enums-in-ruby
* http://www.lesismore.co.za/rubyenums.html
* http://gistflow.com/posts/682-ruby-enums-approaches

=== Async Aggregate Updates

* http://rubylearning.com/blog/2010/11/08/do-you-know-resque[Learning Resque]
* https://devcenter.heroku.com/articles/queuing-ruby-resque[Queuing in Ruby with Redis and Resque - Heroku Blog]
* http://rubyamqp.info/articles/getting_started/#blabblr_onetomany_publishsubscribe_pubsub_example[Ruby Amqp - one to many pub sub]
* https://github.com/nesquena/backburner[Simple and reliable beanstalkd job queue for ruby]
* https://github.com/iron-io/delayed_job_ironmq[IronMQ backend for delayed_job]
* http://www.iron.io/[IronMQ is the Message Queue for the Cloud], see http://www.iron.io/mq[comparison chart]

=== Repository Pattern in Ruby

* http://mattbriggs.net/blog/2012/02/23/repository-pattern-in-ruby/
* https://github.com/nfedyashev/repository[A Ruby implementation of the Repository Pattern - In memory only], developed from https://github.com/alexch/treasury[Repository Pattern for Ruby - 3 years old]. 
* https://github.com/playlouder/persistence[A set of interfaces for, and implementations of, the Repository pattern in Ruby.] This one looks promising.
* https://github.com/brandonweiss/collector[Collector is an implementation of the Repository Pattern for MongoDB]
* https://github.com/braintree/curator[Curator is a model and repository framework for Ruby].Currently, curator supports Riak, MongoDB and an in-memory data store for persistence.

>Curator is a model and repository framework for Ruby. It's an alternative to ActiveRecord-like libraries where models are tightly coupled to persistence. Curator allows you to write domain object that are persistence free, and then write repositories that persist these objects. These ideas are largely taken from the Repository section of Domain Driven Design.

==== Mongoid

* Echo sample app - take a look at `application.rb` - it's using Sidekiq and Kiqstand (not sure what for...maybe could be used for aggregate updates?)
