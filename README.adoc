== Ruby DDD Sample App

=== Goal

The goal of this sample app is to provide an idiomatic Ruby port of the DDD sample application. It should remain faithful to the intention of the purposes of the original DDD sample application:

* Providing a how-to example for implementing a typical DDD application (descriptive, not prescriptive)
* Support discussion of implementation practices
* Lab mouse for controlled experiments

==== DDD Sample Application

* link:https://github.com/patrikfr/dddsample[Written in Java in 2009].

History

* Sep 2008 First public release: 1.0.
* Jan 2009 Sample application tutorial at the JFokus conference in Stockholm.
* Mar 2009 Sample application tutorial at the QCon conference in London.
* Mar 2009 New public release: 1.1.0. See changelog for details.
* 2010/2011 link:https://github.com/SzymonPobiega/DDDSample.Net[Ported to .NET]. 

_The .NET port is being used as the primary basis for this Ruby port._

Details here about other sample apps. Things that are unique to this implementation.

== Implementation Stack

=== Version 1 :: Repositories & Sinatra

* Persistence: MongoDB
* Data access: Curator
* Domain model: Plain 'ol Ruby objects
* UI: Sinatra/Javascript/Twitter bootstrap

=== Version 2 :: Rails

* Persistence: MongoDB
* Data access: Mongoid + Activerecord
* Domain model: Activemodel
* UI: Rails/Javascript/Twitter bootstrap

== Aggregates

The aggregate roots are:

* Cargo
* HandlingEvent
* Location
* Voyage

== Implementation TODOs

See milestones and issues in GitHub repository for high-level.

== Design Decisions

Information on design choices made, and the relative tradeoffs. Plus resources for further reading.

=== Value Objects

==== Immutability in Ruby

* link:https://deveo.com/blog/2013/03/22/immutability-in-ruby-part-1/[Immutability in Ruby - part 1 of 2]
* link:https://deveo.com/blog/2013/03/28/immutability-in-ruby-part-2/[Entities and value objects in Ruby - part 2 of 2]

* http://voormedia.com/blog/2013/02/creating-immutable-tree-data-structures-in-ruby[Creating immutable tree data structures in Ruby - Feb 2013]
* http://www.confreaks.com/videos/2337-mwrc2013-immutable-ruby[Immutable Ruby presentation video (25 mins) - Michael Fairley @ MountainWest RubyConf 2013]
* http://blog.rubybestpractices.com/posts/rklemme/017-Struct.html[Ruby structs inside-out]

==== Libraries/Gems Supporting Immutability in Ruby

* https://rubygems.org/gems/ice_nine[Ice Nine (for deep freezing objects)]
* https://github.com/harukizaemon/hamster[Hamster - Efficient, Immutable, Thread-Safe Collection classes for Ruby]
* https://github.com/tcrayford/values
* https://github.com/solnic/virtus
* https://github.com/rouge-lang/rouge[Ruby + Clojure = Rouge]

=== Enums in Ruby

* http://stackoverflow.com/questions/75759/enums-in-ruby
* http://www.lesismore.co.za/rubyenums.html
* http://gistflow.com/posts/682-ruby-enums-approaches

== Persistence

=== MongoDB

* link:http://speakerdeck.com/u/mongodb/p/domain-driven-design-with-mongodb-chris-hafey-on-point-medical-diagnostics[Presentation on Domain Driven Design with MongoDB]
* link:http://wiki.basho.com/Riak-Compared-to-MongoDB.html[Riak Compared to MongoDB]

==== Mongoid

* Echo sample app - take a look at `application.rb` - it's using Sidekiq and Kiqstand (not sure what for...maybe could be used for aggregate updates?)

=== Repository Pattern in Ruby

* http://mattbriggs.net/blog/2012/02/23/repository-pattern-in-ruby/
* https://github.com/nfedyashev/repository[A Ruby implementation of the Repository Pattern - In memory only], developed from https://github.com/alexch/treasury[Repository Pattern for Ruby - 3 years old]. 
* https://github.com/playlouder/persistence[A set of interfaces for, and implementations of, the Repository pattern in Ruby.] This one looks promising.
* https://github.com/brandonweiss/collector[Collector is an implementation of the Repository Pattern for MongoDB]
* https://github.com/braintree/curator[Curator is a model and repository framework for Ruby].Currently, curator supports Riak, MongoDB and an in-memory data store for persistence.

=== Aggregate Update

Tools for Implementing Eventual Consistency (i.e. performing asynchronous updates).

* http://rubylearning.com/blog/2010/11/08/do-you-know-resque[Learning Resque]
* https://devcenter.heroku.com/articles/queuing-ruby-resque[Queuing in Ruby with Redis and Resque - Heroku Blog]
* http://rubyamqp.info/articles/getting_started/
* https://github.com/nesquena/backburner[Simple and reliable beanstalkd job queue for ruby]
* https://github.com/iron-io/delayed_job_ironmq[IronMQ backend for delayed_job]
* http://www.iron.io/[IronMQ is the Message Queue for the Cloud], see http://www.iron.io/mq[comparison chart]
